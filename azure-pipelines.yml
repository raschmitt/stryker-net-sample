trigger:
- master

pool:
  vmImage: 'ubuntu-latest'

steps:
  - task: DotNetCoreCLI@2
    displayName: 'Build'
    inputs:
      command: 'build'
      workingDirectory: 'Stryker.Net.Sample'
      
  # - task: PowerShell@2
  #   displayName: 'Install coverlet'
  #   inputs:
  #     targetType: 'inline'
  #     script: 'dotnet tool install --tool-path $(Agent.BuildDirectory)/tools'
      
  - task: DotNetCoreCLI@2
    displayName: 'Install coverlet'
    inputs:
      command: custom
      custom: tool
      arguments: 'install coverlet --tool-path $(Agent.BuildDirectory)/tools'

  - task: PowerShell@2
    displayName: 'Test'
    inputs:
      targetType: 'inline'
      script: ' $(Agent.BuildDirectory)/tools/coverlet bin/Debug/netcoreapp3.1/Stryker.Net.Sample.Tests.dll -t dotnet -a "test --no-build" -f opencover'

